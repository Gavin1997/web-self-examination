<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>openlayer版本eyemap | 前端自省清单</title>
    <meta name="description" content="全面、深入解析MDN推荐使用的JavaScript API">
    
    
    <link rel="preload" href="/web-self-examination/assets/css/0.styles.27befe48.css" as="style"><link rel="preload" href="/web-self-examination/assets/js/app.e325b7f8.js" as="script"><link rel="preload" href="/web-self-examination/assets/js/2.f5419a4e.js" as="script"><link rel="preload" href="/web-self-examination/assets/js/32.7204d498.js" as="script"><link rel="prefetch" href="/web-self-examination/assets/js/10.094e6084.js"><link rel="prefetch" href="/web-self-examination/assets/js/11.b506eacb.js"><link rel="prefetch" href="/web-self-examination/assets/js/12.6d132e6e.js"><link rel="prefetch" href="/web-self-examination/assets/js/13.25ec3b04.js"><link rel="prefetch" href="/web-self-examination/assets/js/14.7f4ffd42.js"><link rel="prefetch" href="/web-self-examination/assets/js/15.14d5a2e8.js"><link rel="prefetch" href="/web-self-examination/assets/js/16.84b073a3.js"><link rel="prefetch" href="/web-self-examination/assets/js/17.f52a1d58.js"><link rel="prefetch" href="/web-self-examination/assets/js/18.3f0faa23.js"><link rel="prefetch" href="/web-self-examination/assets/js/19.f9bbe7bf.js"><link rel="prefetch" href="/web-self-examination/assets/js/20.7e6d7151.js"><link rel="prefetch" href="/web-self-examination/assets/js/21.10ac1404.js"><link rel="prefetch" href="/web-self-examination/assets/js/22.9b588e36.js"><link rel="prefetch" href="/web-self-examination/assets/js/23.545a32a6.js"><link rel="prefetch" href="/web-self-examination/assets/js/24.789a41bd.js"><link rel="prefetch" href="/web-self-examination/assets/js/25.27401a1d.js"><link rel="prefetch" href="/web-self-examination/assets/js/26.2c5e173e.js"><link rel="prefetch" href="/web-self-examination/assets/js/27.19f145c3.js"><link rel="prefetch" href="/web-self-examination/assets/js/28.5ded6bd1.js"><link rel="prefetch" href="/web-self-examination/assets/js/29.8c08d5f5.js"><link rel="prefetch" href="/web-self-examination/assets/js/3.f7ff15b3.js"><link rel="prefetch" href="/web-self-examination/assets/js/30.a53ac423.js"><link rel="prefetch" href="/web-self-examination/assets/js/31.f245e75c.js"><link rel="prefetch" href="/web-self-examination/assets/js/33.48f3fd7a.js"><link rel="prefetch" href="/web-self-examination/assets/js/34.b599a972.js"><link rel="prefetch" href="/web-self-examination/assets/js/35.eafb8bb8.js"><link rel="prefetch" href="/web-self-examination/assets/js/36.08945678.js"><link rel="prefetch" href="/web-self-examination/assets/js/37.352661a9.js"><link rel="prefetch" href="/web-self-examination/assets/js/38.6d9b818f.js"><link rel="prefetch" href="/web-self-examination/assets/js/39.c63521d8.js"><link rel="prefetch" href="/web-self-examination/assets/js/4.cd6b5cd3.js"><link rel="prefetch" href="/web-self-examination/assets/js/40.073e2617.js"><link rel="prefetch" href="/web-self-examination/assets/js/41.1e05c652.js"><link rel="prefetch" href="/web-self-examination/assets/js/42.e3b9de05.js"><link rel="prefetch" href="/web-self-examination/assets/js/43.efa0db0a.js"><link rel="prefetch" href="/web-self-examination/assets/js/44.765d031b.js"><link rel="prefetch" href="/web-self-examination/assets/js/45.01e0fac3.js"><link rel="prefetch" href="/web-self-examination/assets/js/46.43b25947.js"><link rel="prefetch" href="/web-self-examination/assets/js/47.4ebad7e9.js"><link rel="prefetch" href="/web-self-examination/assets/js/48.1a762105.js"><link rel="prefetch" href="/web-self-examination/assets/js/49.519c0062.js"><link rel="prefetch" href="/web-self-examination/assets/js/5.bcbc336d.js"><link rel="prefetch" href="/web-self-examination/assets/js/50.d571c416.js"><link rel="prefetch" href="/web-self-examination/assets/js/51.26259090.js"><link rel="prefetch" href="/web-self-examination/assets/js/52.d3d54e18.js"><link rel="prefetch" href="/web-self-examination/assets/js/53.f58b7273.js"><link rel="prefetch" href="/web-self-examination/assets/js/54.8309b9fe.js"><link rel="prefetch" href="/web-self-examination/assets/js/55.f2265d51.js"><link rel="prefetch" href="/web-self-examination/assets/js/6.05fee451.js"><link rel="prefetch" href="/web-self-examination/assets/js/7.a3ade41e.js"><link rel="prefetch" href="/web-self-examination/assets/js/8.10eb3366.js"><link rel="prefetch" href="/web-self-examination/assets/js/9.e0ad901f.js">
    <link rel="stylesheet" href="/web-self-examination/assets/css/0.styles.27befe48.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web-self-examination/" class="home-link router-link-active"><!----> <span class="site-name">前端自省清单</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web-self-examination/JavaScript/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/web-self-examination/HTML/" class="nav-link">HTML</a></div><div class="nav-item"><a href="/web-self-examination/CSS/" class="nav-link">CSS</a></div><div class="nav-item"><a href="http://www.gavin88.top:5800" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/Gavin1997/vuepress_web.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web-self-examination/JavaScript/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/web-self-examination/HTML/" class="nav-link">HTML</a></div><div class="nav-item"><a href="/web-self-examination/CSS/" class="nav-link">CSS</a></div><div class="nav-item"><a href="http://www.gavin88.top:5800" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/Gavin1997/vuepress_web.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>javaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web-self-examination/JavaScript/VarandTypes/" class="sidebar-link">变量和类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#js-规定了几种语言类型" class="sidebar-link">js 规定了几种语言类型</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#js-对象的底层数据结构是什么" class="sidebar-link">js 对象的底层数据结构是什么</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#symbol-类型在实际开发中的应用" class="sidebar-link">Symbol 类型在实际开发中的应用</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#变量在内存中的存储形式" class="sidebar-link">变量在内存中的存储形式</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#null-和-undefined-的区别" class="sidebar-link">null 和 undefined 的区别</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#三种判断-javascript-数据类型的方式" class="sidebar-link">三种判断 JavaScript 数据类型的方式</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#出现小数精度丢失的原因" class="sidebar-link">出现小数精度丢失的原因</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#可能发生隐式类型转换的场景以及转换原则" class="sidebar-link">可能发生隐式类型转换的场景以及转换原则</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/VarandTypes/#理解值类型和引用类型" class="sidebar-link">理解值类型和引用类型</a></li></ul></li><li><a href="/web-self-examination/JavaScript/ProtoAndChain/" class="sidebar-link">原型和原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ProtoAndChain/#理解原型设计模式以及-javascript-中的原型规则" class="sidebar-link">理解原型设计模式以及 JavaScript 中的原型规则</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ProtoAndChain/#instanceof-的底层实现原理，手动实现一个-instanceof" class="sidebar-link">instanceof 的底层实现原理，手动实现一个 instanceof</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ProtoAndChain/#实现继承的几种方式以及他们的优缺点" class="sidebar-link">实现继承的几种方式以及他们的优缺点</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ProtoAndChain/#apply-call-bind-自我实现" class="sidebar-link">apply/call/bind 自我实现</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ProtoAndChain/#至少说出一种开源项目-如-node-中应用原型继承的案例" class="sidebar-link">至少说出一种开源项目(如 Node)中应用原型继承的案例</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ProtoAndChain/#可以描述-new-一个对象的详细过程，手动实现一个-new-操作符" class="sidebar-link">可以描述 new 一个对象的详细过程，手动实现一个 new 操作符</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ProtoAndChain/#理解-es6-class-构造以及继承的底层实现原理" class="sidebar-link">理解 es6 class 构造以及继承的底层实现原理</a></li></ul></li><li><a href="/web-self-examination/JavaScript/ScoprAndClosure/" class="sidebar-link">作用域与闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#理解词法作用域和动态作用域" class="sidebar-link">理解词法作用域和动态作用域</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#理解-javascript-的作用域和作用域链" class="sidebar-link">理解 JavaScript 的作用域和作用域链</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#理解-javascript-的执行上下文栈，可以应用堆栈信息快速定位问题" class="sidebar-link">理解 JavaScript 的执行上下文栈，可以应用堆栈信息快速定位问题</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#this-的原理以及几种不同使用场景的取值" class="sidebar-link">this 的原理以及几种不同使用场景的取值</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#闭包的实现原理和作用，可以列举几个开发中闭包的实际应用" class="sidebar-link">闭包的实现原理和作用，可以列举几个开发中闭包的实际应用</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#理解堆栈溢出和内存泄漏的原理，如何防止" class="sidebar-link">理解堆栈溢出和内存泄漏的原理，如何防止</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#如何处理循环的异步操作" class="sidebar-link">如何处理循环的异步操作</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ScoprAndClosure/#理解模块化解决的实际问题，可列举几个模块化方案并理解其中原理" class="sidebar-link">理解模块化解决的实际问题，可列举几个模块化方案并理解其中原理</a></li></ul></li><li><a href="/web-self-examination/JavaScript/ExecutionMechanism/" class="sidebar-link">执行机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ExecutionMechanism/#为何-try-里面放-return，finally-还会执行，理解其内部机制" class="sidebar-link">为何 try 里面放 return，finally 还会执行，理解其内部机制</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ExecutionMechanism/#javascript-如何实现异步编程，可以详细描述-eventloop-机制" class="sidebar-link">JavaScript 如何实现异步编程，可以详细描述 EventLoop 机制</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ExecutionMechanism/#宏任务和微任务分别有哪些" class="sidebar-link">宏任务和微任务分别有哪些</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ExecutionMechanism/#可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法" class="sidebar-link">可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ExecutionMechanism/#使用-promise-实现串行" class="sidebar-link">使用 Promise 实现串行</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ExecutionMechanism/#node-与浏览器-eventloop-的差异" class="sidebar-link">Node 与浏览器 EventLoop 的差异</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/ExecutionMechanism/#如何在保证页面运行流畅的情况下处理海量数据" class="sidebar-link">如何在保证页面运行流畅的情况下处理海量数据</a></li></ul></li><li><a href="/web-self-examination/JavaScript/GrammarAndApi/" class="sidebar-link">语法和 API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/GrammarAndApi/#理解-ecmascript-和-javascript-的关系" class="sidebar-link">理解 ECMAScript 和 JavaScript 的关系</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/GrammarAndApi/#熟练运用-es5、es6-提供的语法规范，" class="sidebar-link">熟练运用 es5、es6 提供的语法规范，</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/GrammarAndApi/#熟练掌握-javascript-提供的全局对象（例如-date、math）、全局函数（例如-decodeuri、isnan）、全局属性（例如-infinity、undefined）" class="sidebar-link">熟练掌握 JavaScript 提供的全局对象（例如 Date、Math）、全局函数（例如 decodeURI、isNaN）、全局属性（例如 Infinity、undefined）</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/GrammarAndApi/#熟练应用-map、reduce、filter-等高阶函数解决问题" class="sidebar-link">熟练应用 map、reduce、filter 等高阶函数解决问题</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/GrammarAndApi/#setinterval-需要注意的点，使用-settimeout-实现-setinterval" class="sidebar-link">setInterval 需要注意的点，使用 settimeout 实现 setInterval</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/GrammarAndApi/#javascript-提供的正则表达式-api、可以使用正则表达式（邮箱校验、url-解析、去重等）解决常见问题" class="sidebar-link">JavaScript 提供的正则表达式 API、可以使用正则表达式（邮箱校验、URL 解析、去重等）解决常见问题</a></li><li class="sidebar-sub-header"><a href="/web-self-examination/JavaScript/GrammarAndApi/#javascript-异常处理的方式，统一的异常处理方案" class="sidebar-link">JavaScript 异常处理的方式，统一的异常处理方案</a></li></ul></li><li><a href="/web-self-examination/JavaScript/Promise/" class="sidebar-link">Promise的手动实现步骤以及理解</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构和算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>运行环境</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架和类库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webGL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>openLayer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试宝典</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="openlayer版本eyemap"><a href="#openlayer版本eyemap" aria-hidden="true" class="header-anchor">#</a> openlayer版本eyemap</h2> <h2 id="目录结构"><a href="#目录结构" aria-hidden="true" class="header-anchor">#</a> 目录结构</h2> <div class="language- extra-class"><pre class="language-text"><code>
│  │  ├─ EyeMap
│  │  │  ├─ Analysis
│  │  │  │  └─ AnalysisUtils.js # 分析
│  │  │  ├─ DrawAndMeasure
│  │  │  │  └─ DrawManager.js # 画图
│  │  │  ├─ Layer
│  │  │  │  ├─ arcgis
│  │  │  │  │  ├─ ArcGISImageLayer.js 
│  │  │  │  │  ├─ ArcGISImageTileLayer.js 
│  │  │  │  │  ├─ ArcGISTileLayer.js
│  │  │  │  │  └─ ArcGISXYZTileLayer.js
│  │  │  │  ├─ layerUtils.js
│  │  │  │  ├─ other
│  │  │  │  │  ├─ TDTLayer.js # 天地图
│  │  │  │  │  └─ TDTLayerWMTSSource.js
│  │  │  │  └─ supermap
│  │  │  │     ├─ SuperMapImageLayer.js
│  │  │  │     ├─ SuperMapImageSource.js
│  │  │  │     ├─ SuperMapTileLayer.js
│  │  │  │     └─ SuperMapTileSource.js
│  │  │  ├─ Legend
│  │  │  │  ├─ Legend.js
│  │  │  │  ├─ Legend.vue
│  │  │  │  ├─ LegendItem.vue
│  │  │  │  ├─ LegendItemItem.vue
│  │  │  │  └─ LegendUtils.js
│  │  │  ├─ Map
│  │  │  │  ├─ Map.vue
│  │  │  │  └─ index.js
│  │  │  ├─ Query
│  │  │  │  ├─ QueryManager.js # 查询管理
│  │  │  │  └─ QueryTask.js # 查询封装
│  │  │  ├─ Render
│  │  │  │  └─ renderUtils.js # 渲染方法
│  │  │  ├─ Style
│  │  │  │  └─ StyleUtils.js # 样式封装
│  │  │  └─ Utils
│  │  │     ├─ MapUtils.js # 地图方法封装 getLayer 创建矢量图等
│  │  │     ├─ ServiceBase.js # ol.supermap 的服务基类。
│  │  │     ├─ ThemeService.js # 获取专题图信息supermap
│  │  │     ├─ Util.js  # 地图基本方法工具类
│  │  │     ├─ baseUtils.js
│  │  │     ├─ http.js
│  │  │     ├─ locateUtils.js # 定位方法
│  │  │     ├─ mapGrind.js # 地图研磨
│  │  │     ├─ offScreenCanvas.js # offScreenCanvas
│  │  │     └─ worker.js # offScreenCanvasWorker
</code></pre></div><h2 id="地图初始化配置"><a href="#地图初始化配置" aria-hidden="true" class="header-anchor">#</a> 地图初始化配置</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">/*
    设置用户进入系统地图页面的显示范围，根据用户所在组织机构的行政区划代码进行查询
    若用户对应的行政区划代码为000000000000，则不进行查询直接走下一个“extent”节点
    若为其他行政区划代码，则通过对应的url和field进行查询定位
  */</span>
  <span class="token string">&quot;map_locate&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://***/arcgis/rest/services/SCST/XZQH_polygon/MapServer&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;field&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;CODE&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/*
    若运维中给某个用户(组织机构)配了行政区划代码为000000000000，则走该条配置
    通过中心点+比例尺进行定位
    x,y为地图中心点坐标，zoom为比例尺级别，scale为比例尺数值
    其中zoom、scale任意设置其中一个，遍历这2个参数，某个参数有值时就取该参数，并不再向后遍历
    若用zoom定位，scale会被忽略；若用scale定位，zoom设置为null即可
    wkid为地图空间坐标参考
  */</span>
  <span class="token string">&quot;extent&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;x&quot;</span><span class="token punctuation">:</span> <span class="token number">107.871</span><span class="token punctuation">,</span>
    <span class="token string">&quot;y&quot;</span><span class="token punctuation">:</span> <span class="token number">34.444</span><span class="token punctuation">,</span>
    <span class="token string">&quot;zoom&quot;</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">1.9837624000000007E7</span><span class="token punctuation">,</span>
    <span class="token string">&quot;wkid&quot;</span><span class="token punctuation">:</span> <span class="token number">4490</span><span class="token punctuation">,</span>
    <span class="token string">&quot;coordinate&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;epsg&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;EPSG:4490&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;units&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;meter&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// proj为通用坐标系转换工具它将地理空间坐标从一个坐标系转换为另一个坐标系。这包括地图投影和大地坐标变换,epsg.io查看 openlayer默认为epsg:4326和3587</span>
      <span class="token string">&quot;proj&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;+proj=longlat +ellps=GRS80 +no_defs&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;extent&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">107.62672089216353</span><span class="token punctuation">,</span> <span class="token number">24.874617665735485</span><span class="token punctuation">,</span> <span class="token number">112.34700616779583</span><span class="token punctuation">,</span> <span class="token number">29.594902941367778</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">&quot;esriSpatialReference&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;wkid&quot;</span><span class="token punctuation">:</span> <span class="token number">4490</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/*
    天地图的配置信息，一般情况下是不需要修改的
    若系统中没有天地图，也不需要删除
  */</span>
  <span class="token string">&quot;tileInfo&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;dpi&quot;</span><span class="token punctuation">:</span> <span class="token number">96</span><span class="token punctuation">,</span>
    <span class="token string">&quot;rows&quot;</span><span class="token punctuation">:</span> <span class="token number">256</span><span class="token punctuation">,</span>
    <span class="token string">&quot;cols&quot;</span><span class="token punctuation">:</span> <span class="token number">256</span><span class="token punctuation">,</span>
    <span class="token string">&quot;compressionQuality&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">&quot;origin&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;x&quot;</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span>
      <span class="token string">&quot;y&quot;</span><span class="token punctuation">:</span> <span class="token number">90</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;spatialReference&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;wkid&quot;</span><span class="token punctuation">:</span> <span class="token number">4490</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;lods&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.17578125</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">7.39573388636414E7</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.087890625</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">3.69786694318207E7</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.0439453125</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">1.848933471591035E7</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.02197265625</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">9244667.357955175</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.010986328125</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">4622333.678977588</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.0054931640625</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">2311166.839488794</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.00274658203125</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">1155583.419744397</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.001373291015625</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">577791.7098721985</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.0006866455078125</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">288895.85493609926</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.00034332275390625</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">144447.92746804963</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">0.000171661376953125</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">72223.96373402482</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">8.58306884765625e-5</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">36111.98186701241</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">4.291534423828125e-5</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">18055.990933506204</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">2.1457672119140625e-5</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">9027.995466753102</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">1.0728836059570313e-5</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">4513.997733376551</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resolution&quot;</span><span class="token punctuation">:</span> <span class="token number">5.3644180297851563e-6</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scale&quot;</span><span class="token punctuation">:</span> <span class="token number">2256.998866688275</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="图层管理"><a href="#图层管理" aria-hidden="true" class="header-anchor">#</a> 图层管理</h2> <ul><li>加载图层组</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> Layers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
   layerID<span class="token punctuation">:</span> <span class="token number">4</span>
   name<span class="token punctuation">:</span> <span class="token string">&quot;合规审查面&quot;</span>
   platform<span class="token punctuation">:</span> <span class="token string">&quot;arcgis&quot;</span>
   type<span class="token punctuation">:</span> <span class="token string">&quot;dynamic&quot;</span>
   url<span class="token punctuation">:</span> <span class="token string">&quot;http://***/arcgis/rest/services/YZT/JSFW/MapServer&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">]</span>
 isLocate 是否定位
 isRenderLegend 是否渲染图例

 <span class="token function">addLocateLayers</span><span class="token punctuation">(</span>layers<span class="token punctuation">,</span> isLocate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> isRenderLegend <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>加载单个图层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layerInfo<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  layerID<span class="token punctuation">:</span> <span class="token number">4</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;合规审查面&quot;</span>
  platform<span class="token punctuation">:</span> <span class="token string">&quot;arcgis&quot;</span>
  type<span class="token punctuation">:</span> <span class="token string">&quot;dynamic&quot;</span>
  url<span class="token punctuation">:</span> <span class="token string">&quot;http://***/arcgis/rest/services/YZT/JSFW/MapServer&quot;</span>
<span class="token punctuation">}</span>
isLocate 是否定位
isRenderLegend 是否渲染图例
group 默认为<span class="token number">0</span><span class="token punctuation">,</span> 但一般使用加载图层组的时候为<span class="token number">1</span><span class="token punctuation">,</span> 避免加载租的时候定位重复<span class="token punctuation">,</span> 单独调用此方法可不传
<span class="token function">addLocateLayer</span><span class="token punctuation">(</span>layerInfo<span class="token punctuation">,</span> isLocate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> isRenderLegend <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> group <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>删除图层组</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  platform<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  type<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  layerID<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  layerName<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token function">removeLayers</span><span class="token punctuation">(</span>layers<span class="token punctuation">)</span>
</code></pre></div><ul><li>删除图层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 参数同上</span>
<span class="token function">removeLayer</span><span class="token punctuation">(</span>layerInfo<span class="token punctuation">)</span>
</code></pre></div><ul><li>关闭图层组</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 参数同上</span>
<span class="token function">closeLayers</span><span class="token punctuation">(</span>layers<span class="token punctuation">)</span>
</code></pre></div><ul><li>关闭图层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 参数同上</span>
<span class="token function">closeLayer</span><span class="token punctuation">(</span>layerInfo<span class="token punctuation">)</span>
</code></pre></div><ul><li>缩放到专题</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 图层组
<span class="token function">zoomToLayers</span><span class="token punctuation">(</span>layers<span class="token punctuation">)</span>
</code></pre></div><ul><li>改变图层组的透明度</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 图层组
opacity<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">1</span> 透明度
<span class="token function">changeLayersOpacity</span><span class="token punctuation">(</span>layers<span class="token punctuation">,</span> opacity<span class="token punctuation">)</span>
</code></pre></div><ul><li>改变图层的透明度</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeLayerOpacity</span><span class="token punctuation">(</span>layerInfo<span class="token punctuation">,</span> opacity<span class="token punctuation">)</span>
</code></pre></div><ul><li>获取图层元数据信息&amp;&amp;判断服务图层是否存在</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>serviceUrl <span class="token operator">-</span> 图层服务地址
platform <span class="token operator">-</span> 图层所属服务的发布平台<span class="token punctuation">:</span> arcgis supermap
layerInfo <span class="token operator">-</span> 图层信息
<span class="token function">getLayerMetaData</span><span class="token punctuation">(</span><span class="token parameter">serviceUrl<span class="token punctuation">,</span> platform<span class="token punctuation">,</span> layerInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre></div><ul><li>图层组加载完毕事件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>openlayer <span class="token operator">-</span> 实例过后的openlayer图层
最后请监听layerLoadComplete事件
<span class="token function">updateLayerProgress</span><span class="token punctuation">(</span>openlayer<span class="token punctuation">)</span>
</code></pre></div><ul><li>底图是否可见</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>isDisplayMap <span class="token operator">-</span> 布尔值 是否显示底图
<span class="token function">changeMapDisplay</span><span class="token punctuation">(</span>isDisplayMap<span class="token punctuation">)</span>
</code></pre></div><ul><li>底图置灰</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>isGrayMap <span class="token operator">-</span> 布尔值 是否将底图置灰
<span class="token function">changeMapGray</span><span class="token punctuation">(</span>isGrayMap<span class="token punctuation">)</span>
</code></pre></div><ul><li>根据id找到对应图层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layerId <span class="token operator">-</span> 图层id<span class="token punctuation">,</span> 可能为运维专题生成的guid<span class="token punctuation">,</span> 也有可能为手动加上的id <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url <span class="token operator">+</span> <span class="token string">&quot;_shadow_&quot;</span>layerID<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token function">findLayerById</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span>
</code></pre></div><ul><li>获取最上层的业务图层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">return</span> topLayer
<span class="token function">getTopOperationLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>创建graphicsLayer</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layerId 要创建的graphicsLayer的id
<span class="token keyword">return</span> graphicsLayer图层
<span class="token function">createGraphicsLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span>
</code></pre></div><ul><li>将所有GraphicsLayer置于顶层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 实际为layerId为GraphicsLayer 放到顶层</span>
<span class="token function">resetGraphicsLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>调整图层位置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layerObj <span class="token operator">-</span> 图层对象<span class="token punctuation">,</span> 该图层已存在于Map中
index <span class="token operator">-</span> 调整后的图层层级<span class="token punctuation">,</span> 不传则移到最上层
<span class="token function">reorderLayer</span><span class="token punctuation">(</span>layerObj<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">9999</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>调整专题顺序</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>oldTopic <span class="token operator">-</span> 之前的图层guid即专题id
newTopic <span class="token operator">-</span> 需要调整的图层guid
<span class="token function">reorderTopicLayer</span><span class="token punctuation">(</span>oldTopic<span class="token punctuation">,</span> newTopic<span class="token punctuation">)</span>
</code></pre></div><ul><li>设置地图服务过滤</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>param <span class="token operator">-</span> url<span class="token punctuation">,</span> layerID<span class="token punctuation">,</span> filter
监听filterMap事件
<span class="token function">filterLayer</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
</code></pre></div><ul><li>清空所有图层-除底图图层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">removeAllLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>cad转图片</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>mapView <span class="token operator">-</span> mapView对象
file <span class="token operator">-</span> 文件
loadFile <span class="token operator">-</span> 布尔值 是否加载文件
map <span class="token operator">-</span> map实例对象
<span class="token function">getImageInfo</span><span class="token punctuation">(</span>mapView<span class="token punctuation">,</span> file<span class="token punctuation">,</span> loadFile<span class="token punctuation">,</span> map<span class="token punctuation">)</span>
</code></pre></div><ul><li>创建cad动态图层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>map <span class="token operator">-</span> map实例
layerId <span class="token operator">-</span> dynamicLayer服务对应的图层id<span class="token punctuation">,</span> 一般为<span class="token number">0</span>
sublayers <span class="token operator">-</span> 更改dynamicLayer的sublayers参数
url <span class="token operator">-</span> dynamicLayer服务地址
<span class="token keyword">return</span> cadLayer
<span class="token function">createCADDynamicLayer</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> layerId<span class="token punctuation">,</span> sublayers<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
</code></pre></div><ul><li>通过指定layerid的图层，加载并返回 -辅助编制用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>url <span class="token operator">-</span> 服务地址
layerIDs <span class="token operator">-</span> 图层id数组
isVisible <span class="token operator">-</span> 是否显示
isLocate <span class="token operator">-</span> 是否定位
isRenderLegend <span class="token operator">-</span> 是否渲染图例
<span class="token keyword">return</span> layerIDs的layers
<span class="token function">addSpecificLayersByUrlAndlayerIDs</span><span class="token punctuation">(</span>
  url<span class="token punctuation">,</span>
  layerIDs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  isVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  isLocate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  isRenderLegend <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="图例"><a href="#图例" aria-hidden="true" class="header-anchor">#</a> 图例</h2> <ul><li>获取服务图列 arcgis和Super M平</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>legendUrlInfo<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  url<span class="token punctuation">,</span>
  platform<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token function">getServiceLegend</span><span class="token punctuation">(</span>legendUrlInfo<span class="token punctuation">)</span>
</code></pre></div><ul><li>设置图例渲染-要素图列</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>response为地图服务查询元数据
legendRenderArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> layerInfo<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
  layerGuid<span class="token punctuation">:</span> layerInfo<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  layerID<span class="token punctuation">:</span> layerInfo<span class="token punctuation">.</span>layerID<span class="token punctuation">,</span>
  layerName<span class="token punctuation">:</span> layerInfo<span class="token punctuation">.</span>layerName<span class="token punctuation">,</span>
  groupLayerId<span class="token punctuation">:</span> response<span class="token punctuation">.</span>groupLayerId<span class="token punctuation">,</span>
  groupLayerName<span class="token punctuation">:</span> response<span class="token punctuation">.</span>groupLayerName<span class="token punctuation">,</span>
  platform<span class="token punctuation">:</span> layerInfo<span class="token punctuation">.</span>platform<span class="token punctuation">,</span>
  type<span class="token punctuation">:</span> layerInfo<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
  legendFilterNames<span class="token punctuation">:</span> layerInfo<span class="token punctuation">.</span>legendFilterNames<span class="token punctuation">,</span>
  metadata<span class="token punctuation">:</span> response<span class="token punctuation">,</span>
  operation<span class="token punctuation">:</span> <span class="token string">&quot;add&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">setFeatureLegend</span><span class="token punctuation">(</span>legendRenderArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
如何是删除的话 参数相同 调用方式也相同 只用将operation<span class="token punctuation">:</span> <span class="token string">&quot;remove&quot;</span>
即可
</code></pre></div><ul><li>通过legend组件控制图层的显隐</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>param<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  layerID<span class="token punctuation">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
  platform<span class="token punctuation">:</span> <span class="token string">&quot;arcgis&quot;</span><span class="token punctuation">,</span>
  uid<span class="token punctuation">:</span> <span class="token string">&quot;0f4fed5a-6038-4e1c-a300-65bf30b65e63&quot;</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">&quot;http://***/arcgis/rest/services/YZT/YZTYLSJ/MapServer&quot;</span>
  visible<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token function">controlMapVisible</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
</code></pre></div><ul><li>通过图列控制要素在图层中的显隐</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>params<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  filterValue<span class="token punctuation">:</span> <span class="token string">&quot;农业农村发展区&quot;</span><span class="token punctuation">,</span>
  groupLayerId<span class="token punctuation">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  groupLayerName<span class="token punctuation">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  layerID<span class="token punctuation">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
  layerName<span class="token punctuation">:</span> <span class="token string">&quot;国土空间规划分区&quot;</span><span class="token punctuation">,</span>
  platform<span class="token punctuation">:</span> <span class="token string">&quot;arcgis&quot;</span><span class="token punctuation">,</span>
  uid<span class="token punctuation">:</span> <span class="token string">&quot;0f4fed5a-6038-4e1c-a300-65bf30b65e63&quot;</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">&quot;http://***/arcgis/rest/services/YZT/YZTYLSJ/MapServer&quot;</span>
<span class="token punctuation">}</span>
<span class="token function">filterMap</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
</code></pre></div><ul><li>设置图例渲染-渲染图例(矢量渲染, 一般监测预警, 资源环境承载力用的较多)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> param <span class="token operator">-</span>
   legends<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
     color<span class="token punctuation">:</span> <span class="token string">&quot;#F5222D&quot;</span>
     index<span class="token punctuation">:</span> <span class="token string">&quot;超载&quot;</span>
   <span class="token punctuation">}</span><span class="token punctuation">]</span>

 <span class="token function">setRenderLegend</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
</code></pre></div><h2 id="定位locate"><a href="#定位locate" aria-hidden="true" class="header-anchor">#</a> 定位locate</h2> <ul><li>根据四至范围定位</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>extent<span class="token punctuation">[</span>minx<span class="token punctuation">,</span> miny<span class="token punctuation">,</span> maxx<span class="token punctuation">,</span> maxy<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span>
  xmin<span class="token punctuation">,</span>
  ymin<span class="token punctuation">,</span>
  xmax<span class="token punctuation">,</span>
  ymax
<span class="token punctuation">}</span>
<span class="token function">locateByExtent</span><span class="token punctuation">(</span>extent<span class="token punctuation">)</span>
</code></pre></div><ul><li>根据坐标点和缩放层级缩放</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>x<span class="token punctuation">,</span> y 坐标点xy zoom 层级
<span class="token function">locateByCoordinate</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> zoom <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mapView<span class="token punctuation">.</span><span class="token function">getZoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>根据geometrys定位</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> geometries geometry数组
 isLocate 是否定位
 isRender 是否渲染
 symbol 渲染symbol
 isClearLayer 是否清除graphicslayer
 <span class="token function">locateByGeometries</span><span class="token punctuation">(</span>
   geometries<span class="token punctuation">,</span>
   isLocate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   isRender<span class="token punctuation">,</span>
   symbol <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
   isClearLayer <span class="token operator">=</span> <span class="token boolean">true</span>
 <span class="token punctuation">)</span>
</code></pre></div><ul><li>根据featrues定位</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>features <span class="token operator">-</span> 要素集
<span class="token function">locateByFeatures</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> isLocate<span class="token punctuation">,</span> isRender<span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> isClearLayer <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>根据regioncode 定位</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>ownRegion <span class="token operator">-</span> <span class="token function">行政区划code</span><span class="token punctuation">(</span>注意行政区划服务<span class="token number">6</span>位或者<span class="token number">12</span>位<span class="token punctuation">)</span>
<span class="token function">locateByRegionCode</span><span class="token punctuation">(</span>ownRegion<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
</code></pre></div><h2 id="查询方法"><a href="#查询方法" aria-hidden="true" class="header-anchor">#</a> 查询方法</h2> <ul><li>query查询封装, 支持超图和esri服务</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>     url 查询服务url地址
     dataSetArr 地图服务查询数据集数组<span class="token punctuation">,</span> 用于超图服务查询<span class="token punctuation">,</span> 此时layerID请传<span class="token keyword">null</span>或不传
     layerID 地图服务图层<span class="token constant">ID</span><span class="token punctuation">,</span> 用于<span class="token constant">ESRI</span>查询服务<span class="token punctuation">,</span> 此时dataSetArr请传<span class="token keyword">null</span>或不传
     sql 查询<span class="token constant">SQL</span>语句
     geometry 查询范围几何图形
     spatialRelationship 空间图形查询关系
     outFields 导出的字段<span class="token punctuation">,</span> 不传默认为 <span class="token operator">*</span> 全部导出多个请用逗号隔开 <span class="token string">&quot;a,b,c&quot;</span>
     <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       url<span class="token punctuation">,</span>
       dataSetArr<span class="token punctuation">,</span>
       objectIds<span class="token punctuation">,</span>
       layerID<span class="token punctuation">,</span>
       sql<span class="token punctuation">,</span>
       geometry <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
       outFields <span class="token operator">=</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span>
       spatialRelationship
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>Identify查询-即属性查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>   url 查询服务地址
   layerIDs 查询图层数组
   dataSetArr 地图服务查询数据集数组<span class="token punctuation">,</span> 用于超图服务查询<span class="token punctuation">,</span> 此时layerID请传<span class="token keyword">null</span>或不传<span class="token punctuation">,</span> 超图查询featureResults
   geometry 查询范围

   <span class="token function">identify</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
       url<span class="token punctuation">,</span>
       layerIDs<span class="token punctuation">,</span>
       dataSetArr<span class="token punctuation">,</span>
       geometry
     <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre></div><ul><li>获取图层中指定字段的所有不同的值</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> url 图层url地址
 dataSetArr 超图服务要素集数组
 layerID esri服务图层id
 groupByField 分类字段<span class="token punctuation">,</span> 返回唯一值的字段

 <span class="token function">queryDistinctValues</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   url<span class="token punctuation">,</span>
   dataSetArr<span class="token punctuation">,</span>
   layerID<span class="token punctuation">,</span>
   groupByField
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>Find查询</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  url 查询服务url地址
  layerIDs 查询图层数组
  dataSetArr 地图服务查询数据集数组<span class="token punctuation">,</span> 用于超图服务查询<span class="token punctuation">,</span> 此时layerID请传<span class="token keyword">null</span>或不传
  searchText 查询关键字
  searchFields 查询字段名称

  <span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token punctuation">,</span>
    layerIDs<span class="token punctuation">,</span>
    dataSetArr<span class="token punctuation">,</span>
    searchText<span class="token punctuation">,</span>
    searchFields
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>自定义query查询, 利用query查询接口的丰富性, 旨在突破查询结果1000条的限制, 超图服务有现成的参数可设置maxFeatures, 主要针对esri服务</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>url
layerID
sql
geometry <span class="token operator">-</span> 此处为arcgis格式的geometry
<span class="token function">queryBreakLimit</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> layerID<span class="token punctuation">,</span> sql <span class="token operator">=</span> <span class="token string">&quot;1=1&quot;</span><span class="token punctuation">,</span> geometry <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> objectIds <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="渲染矢量图层"><a href="#渲染矢量图层" aria-hidden="true" class="header-anchor">#</a> 渲染矢量图层</h2> <ul><li>区域面颜色渲染-带文字图例</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    layerInfo 渲染图层信息
    isShowLegend 是否渲染图例
    isShowTip <span class="token function">是否显示提示信息</span><span class="token punctuation">(</span>tootip<span class="token punctuation">)</span>
    isLocate 是否定位
    <span class="token function">rendererRegionPolygon</span><span class="token punctuation">(</span>layerInfo<span class="token punctuation">,</span> isShowLegend <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> isShowTip <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> isLocate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>监测预警, 渲染区域点（带有数字的发散圆点, 面加载渲染，点查询渲染，鼠标移入移出点击事件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> layerInfo 渲染图层信息
 isShowLabel 是否显示气泡数字
 isShowRegion 是否显示区域
 isShowLegend 是否显示图例
 isLocate 是否定位
 <span class="token function">rendererRegionPointByFlashMarker</span><span class="token punctuation">(</span>layerInfo<span class="token punctuation">,</span> isShowLabel<span class="token punctuation">,</span> isShowRegion<span class="token punctuation">,</span> isShowLegend<span class="token punctuation">,</span> isLocate<span class="token punctuation">)</span>
</code></pre></div><ul><li>清除渲染的Theme层</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">removeRenderLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>*清除渲染的Vector层数据</p> <div class="language-js extra-class"><pre class="language-js"><code>locate 是否定位初始状态
<span class="token function">clearFeatures</span><span class="token punctuation">(</span>locate<span class="token punctuation">)</span>
</code></pre></div><ul><li>清除地图上的鼠标事件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">clearMapOperate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>删除指定GraphicsLayer图层之外的所有GraphicsLayer</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>graphicLayerID <span class="token operator">-</span> 要删除的graphicLayerId
<span class="token function">removeExceptGraphicsLayer</span><span class="token punctuation">(</span>graphicLayerID <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>清除指定GraphicsLayer图层之外的所有GraphicsLayer要素</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>graphicLayerID <span class="token operator">-</span> 要清除要素的layerId
<span class="token function">cleanExceptGraphicsLayer</span><span class="token punctuation">(</span>graphicLayerID <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>根据设置的symbol对象转为ol的style</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>symbol <span class="token operator">-</span> 为之前各业务系统自己写的一些样式<span class="token punctuation">,</span> 个通过此方法转换为ol格式的style
<span class="token function">getFeatureRenderStyle</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span>
</code></pre></div><ul><li>根据图形json数组生成graphic数组，渲染定位</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>polygonJsons <span class="token operator">-</span> geoJson 数组集合
isLocate <span class="token operator">-</span> 是否定位
icClearLayer <span class="token operator">-</span> 是否清除layer
tipis <span class="token operator">-</span> 鼠标显示的tipis信息
<span class="token function">createGeoJSONLayer</span><span class="token punctuation">(</span>
  polygonJsons<span class="token punctuation">,</span>
  isLocate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  isClearLayer<span class="token punctuation">,</span>
  layerId
<span class="token punctuation">)</span>
</code></pre></div><ul><li>清除geojsonLayer</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>isLocate <span class="token operator">-</span> 是否定位
<span class="token function">clearGeojsonLayer</span><span class="token punctuation">(</span>isLocate<span class="token punctuation">)</span>
</code></pre></div><ul><li>辅助编制, 根据多个区域渲染地图</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>layerInfo<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  codeField<span class="token punctuation">,</span>
  renderUrl<span class="token punctuation">,</span>
  renderLayerID<span class="token punctuation">,</span>
  platform<span class="token punctuation">,</span>
  regions
<span class="token punctuation">}</span>
<span class="token function">rendererMultiRegions</span><span class="token punctuation">(</span>layerInfo<span class="token punctuation">,</span> isLocate<span class="token punctuation">,</span> isRender<span class="token punctuation">)</span>
</code></pre></div><ul><li>渲染临时graphic数据</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>tempGraphics <span class="token operator">-</span> graphic数组集合
<span class="token function">renderTempGraphics</span><span class="token punctuation">(</span>tempGraphics<span class="token punctuation">)</span>
</code></pre></div><ul><li>清除临时graphic数据</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">clearTempGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="分析方法"><a href="#分析方法" aria-hidden="true" class="header-anchor">#</a> 分析方法</h2> <ul><li>buffer封装</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> url 查询服务url地址
 flag 服务类型 <span class="token operator">-</span> arcgis<span class="token punctuation">,</span> supermap<span class="token punctuation">,</span> other
 geometries <span class="token operator">-</span> 地图服务分析的几何图形数组， supermap只能单个进行缓冲， 需要循环
 distances <span class="token operator">-</span> 缓冲分析得距离
 unionResults <span class="token operator">-</span> 判断分析结果是否合并<span class="token punctuation">,</span> 用于esri服务
 <span class="token keyword">return</span> olGeo promise
 <span class="token function">buffer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   url<span class="token punctuation">,</span>
   flag<span class="token punctuation">,</span>
   geometries<span class="token punctuation">,</span>
   distances<span class="token punctuation">,</span>
   unionResults
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>intersect封装</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>   intersect封装<span class="token punctuation">,</span> 支持supermap和arcgis 相交查询
   url 查询服务url地址
   flag 服务类型 <span class="token operator">-</span> arcgis <span class="token operator">/</span> supermap <span class="token operator">/</span> other
   sourceGeometries <span class="token operator">-</span> 被做intersect的图形集合
   operateGeometries <span class="token operator">-</span> 做intersect的图形集合（ arcgis只能单个）
   <span class="token keyword">return</span> olGeo Promise
   <span class="token function">intersect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     url<span class="token punctuation">,</span>
     flag<span class="token punctuation">,</span>
     sourceGeometries<span class="token punctuation">,</span>
     operateGeometries
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>difference封装 一个几何图形减去它与另一个几何图形相交的部分</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">difference</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">,</span>
  flag<span class="token punctuation">,</span>
  sourceGeometries<span class="token punctuation">,</span>
  operateGeometries
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>union封装 , 使用turf.js 合并两个同维度的几何对象为单个几何对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">union</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   url<span class="token punctuation">,</span>
   flag<span class="token punctuation">,</span>
   geometries
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>计算图形的面积和长度, 先封装arcgis,</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>geometries 传入的格式为ol格式的geometry数据
param 传入的查询参数 <span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    areaUnit<span class="token punctuation">:</span> <span class="token string">&quot;esriSquareMeters&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">calculateAreaAndLength</span><span class="token punctuation">(</span>geometries<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
</code></pre></div><h2 id="画图工具"><a href="#画图工具" aria-hidden="true" class="header-anchor">#</a> 画图工具</h2> <ul><li>激活eyemap绘制功能</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>drawType 绘制类型point<span class="token punctuation">,</span> polyline<span class="token punctuation">,</span> freeline<span class="token punctuation">,</span> polygon<span class="token punctuation">,</span> freepolygon<span class="token punctuation">,</span> rectangle<span class="token punctuation">,</span> circle<span class="token punctuation">,</span> locate<span class="token punctuation">,</span> text
isContinueDraw 绘制完成后是否可以继续绘制
isClear 渲染数据前是否清除已有的数据
isAutoRender 是否自动绘制到默认图层<span class="token punctuation">,</span> 默认为<span class="token boolean">true</span><span class="token punctuation">,</span> 如果为<span class="token boolean">false</span><span class="token punctuation">,</span> 请监听map实例的draw <span class="token operator">-</span> geometry事件
<span class="token function">openDrawMap</span><span class="token punctuation">(</span>
  drawType<span class="token punctuation">,</span>
  isContinueDraw <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  isClear <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  isAutoRender <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Gavin1997/vuepress_web.git/edit/master/docs/OneMap/OpenlayerEyeMap/readme.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">12/14/2020, 5:39:46 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/web-self-examination/assets/js/app.e325b7f8.js" defer></script><script src="/web-self-examination/assets/js/2.f5419a4e.js" defer></script><script src="/web-self-examination/assets/js/32.7204d498.js" defer></script>
  </body>
</html>
